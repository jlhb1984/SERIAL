;
; SERIAL.asm
;
; Created: 10/12/2024 4:23:42 p.Â m.
; Author : Jose Luis Hurtado
;


; Replace with your application code
START:
	LDI		R16,HIGH(RAMEND)
	OUT		SPH,R16
	LDI		R16,LOW(RAMEND)
	OUT		SPL,R16
	LDI		R16,0B11111010		;PD0(RX) INPUT, PD1 (TX) OUTPUT, PD2(BUTTON) INPUT.
	OUT		DDRD,R16

CONFIGUSART:
	LDI		R16,0B00000000	
	OUT		UBRRH,R16			;CARGA DE 9600BAUDIOS
	LDI		R16,0B00000110
	OUT		UBRRL,R16			;CARGA DE 9600BAUDIOS
	LDI		R16,0B00000000	
	OUT		UCSRA,R16			;RXC=0 TXC=0 UDRE=0 FE=0 DOR=0 PE=0 <- FLAGS / U2X=0 MPCM=0
	LDI		R16,0B10000110
	OUT		UCSRC,R16		;URSEL=1 USMEL=0 UPM=00 USBS=0 UCSZ=11 UCPOL=0
	LDI		R16,0B00001000
	OUT		UCSRB,R16			;RXCIE=0 TXCIE=0 UDRIE=0 RXEN=0 TXEN=1 UCSZ=0 RXB8TXB8=00
	LDI		R18,0B11111111

TX:	
	LDI		R16,0B01000000
	OUT		UDR,R16

ESPERATX1:
	INC		R17
	CPSE	R17,R18
	RJMP	ESPERATX1
	CLR		R17
	
ESPERATX2:
	INC		R17
	CPSE	R17,R18
	RJMP	ESPERATX2
	CLR		R17
	RJMP	TX